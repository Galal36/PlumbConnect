# PlumbingConnect API - Complaints App Examples for Postman

# Base URL: http://localhost:8000/api/complaints/
# Headers for all requests:
# Authorization: Bearer <YOUR_JWT_TOKEN>
# Content-Type: application/json (for POST/PATCH)
# Accept-Language: ar (Optional, for Arabic responses)

# 1. Get My Complaints (عرض الشكاوى التي قدمتها أو قُدمت ضدي)
# Description: Retrieve a list of complaints the authenticated user is involved in (filed by or against them).

# Method: GET
# URL: http://localhost:8000/api/complaints/my-complaints/
# Query Params:
#   status: pending/in_progress/resolved/rejected (Optional, to filter by status)
#   complaint_type: user_behavior/service_quality/payment_issue/spam/other (Optional, to filter by type)
# Example Response (Status: 200 OK):
# [
#     {
#         "id": 1,
#         "title": "تأخير في الموعد",
#         "description": "السباك تأخر ساعتين عن الموعد المحدد بدون إشعار مسبق",
#         "complaint_type": "service_quality",
#         "from_user": { "id": 1, "name": "محمد أحمد", "role": "client", "image": null, "is_verified": false },
#         "to_user": { "id": 2, "name": "علي السباك", "role": "plumber", "image": "http://localhost:8000/media/plumber_images/ali.jpg", "is_verified": true },
#         "chat": 1,
#         "status": "pending",
#         "created_at": "2025-08-05T21:00:00Z",
#         "updated_at": "2025-08-05T21:00:00Z",
#         "resolved_by": null,
#         "admin_notes": "",
#         "from_user_name": "محمد أحمد",
#         "to_user_name": "علي السباك",
#         "resolved_by_name": null
#     }
# ]

---

# 2. Create a New Complaint (تقديم شكوى جديدة)
# Description: File a new complaint against another user.
# Method: POST
# URL: http://localhost:8000/api/complaints/
# Request Body (JSON):
# {
#     "title": "سلوك غير لائق",
#     "description": "المستخدم قام بإرسال رسائل غير لائقة.",
#     "complaint_type": "user_behavior",

#     "to_user_id": 2, # يجب أن يكون ID لمستخدم مختلف عن المستخدم الحالي
#     "chat_id": 1     # اختياري: ID المحادثة المرتبطة بالشكوى

# }
# Example Response (Status: 201 Created):
# {
#     "id": 2,
#     "title": "سلوك غير لائق",
#     "description": "المستخدم قام بإرسال رسائل غير لائقة.",
#     "complaint_type": "user_behavior",
#     "from_user": { "id": 1, "name": "محمد أحمد", "role": "client", "image": null, "is_verified": false },
#     "to_user": { "id": 2, "name": "علي السباك", "role": "plumber", "image": "http://localhost:8000/media/plumber_images/ali.jpg", "is_verified": true },
#     "chat": 1,
#     "status": "pending",
#     "created_at": "2025-08-05T21:30:00Z",
#     "updated_at": "2025-08-05T21:30:00Z",
#     "resolved_by": null,
#     "admin_notes": "",
#     "from_user_name": "محمد أحمد",
#     "to_user_name": "علي السباك",
#     "resolved_by_name": null
# }

---

# 3. Get Complaint Detail (عرض تفاصيل شكوى معينة)
# Description: Retrieve details of a specific complaint by its ID.
# Method: GET
# URL: http://localhost:8000/api/complaints/1/
# Example Response (Status: 200 OK):
# {
#     "id": 1,
#     "title": "تأخير في الموعد",
#     "description": "السباك تأخر ساعتين عن الموعد المحدد بدون إشعار مسبق",
#     "complaint_type": "service_quality",
#     "from_user": { "id": 1, "name": "محمد أحمد", "role": "client", "image": null, "is_verified": false },
#     "to_user": { "id": 2, "name": "علي السباك", "role": "plumber", "image": "http://localhost:8000/media/plumber_images/ali.jpg", "is_verified": true },
#     "chat": 1,
#     "status": "pending",
#     "created_at": "2025-08-05T21:00:00Z",
#     "updated_at": "2025-08-05T21:00:00Z",
#     "resolved_by": null,
#     "admin_notes": "",
#     "from_user_name": "محمد أحمد",
#     "to_user_name": "علي السباك",
#     "resolved_by_name": null
# }

---
# 4. Update Complaint Status/Notes (تحديث حالة الشكوى/ملاحظات) - (Admin Only)
# Description: Update the status or add admin notes to a complaint. Only Admin users can perform this action.
# Method: PATCH
# URL: http://localhost:8000/api/complaints/1/admin-update/
# Request Body (JSON):
# {
#     "status": "resolved",

#     "admin_notes": "تم التواصل مع السباك وحل المشكلة."
# }
# Example Response (Status: 200 OK):
# {
#     "id": 1,
#     "title": "تأخير في الموعد",
#     "description": "السباك تأخر ساعتين عن الموعد المحدد بدون إشعار مسبق",
#     "complaint_type": "service_quality",
#     "from_user": { "id": 1, "name": "محمد أحمد", "role": "client", "image": null, "is_verified": false },
#     "to_user": { "id": 2, "name": "علي السباك", "role": "plumber", "image": "http://localhost:8000/media/plumber_images/ali.jpg", "is_verified": true },
#     "chat": 1,
#     "status": "resolved",
#     "created_at": "2025-08-05T21:00:00Z",
#     "updated_at": "2025-08-05T22:00:00Z",
#     "resolved_by": { "id": 3, "name": "مدير النظام", "role": "admin", "image": null, "is_verified": true },
#     "admin_notes": "تم التواصل مع السباك وحل المشكلة.",
#     "from_user_name": "محمد أحمد",
#     "to_user_name": "علي السباك",
#     "resolved_by_name": "مدير النظام"
# }

---

# 5. Get All Complaints (عرض جميع الشكاوى) - (Admin Only)
# Description: Retrieve a list of all complaints in the system. Only Admin users can perform this action.
# Method: GET
# URL: http://localhost:8000/api/complaints/admin-list/
# Query Params: (Same as "Get My Complaints")
# Example Response (Status: 200 OK): (Similar to "Get My Complaints" but includes all complaints)

---

# 6. Get Complaints by Status (عرض الشكاوى حسب الحالة)
# Description: Retrieve a list of complaints filtered by a specific status.
# Method: GET
# URL: http://localhost:8000/api/complaints/status/pending/
# Example Response (Status: 200 OK): (List of complaints with 'pending' status)

---

# 7. Get Complaint Count (الحصول على عدد الشكاوى)
# Description: Get the total count of complaints for the authenticated user (or all for admin).
# Method: GET
# URL: http://localhost:8000/api/complaints/count/
# Example Response (Status: 200 OK):
# {
#     "total_complaints_count": 5
# }

---

# 8. Delete a Complaint (حذف شكوى) - (Admin Only)
# Description: Permanently delete a complaint by its ID. Only Admin users can perform this action.
# Method: DELETE
# URL: http://localhost:8000/api/complaints/1/delete/
# Example Response (Status: 204 No Content): (Empty response body)

